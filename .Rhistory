m.plot2 <- emmip(m.model4, sex2 ~ agegrp2, scales = reverse_trans(), ylim = c(0, 2), type = "response", CIs = TRUE)
m.plot2
m.plot2 <- emmip(m.model4, sex2 ~ agegrp2, scales = exp_trans(), ylim = c(0, 2), type = "response", CIs = TRUE)
m.plot2
m.plot2 <- emmip(m.model4, sex2 ~ agegrp2, type = "response", CIs = TRUE)
m.plot2
## Required packages
library(assertthat)
library(epiDisplay)
library(dplyr)
library(knitr)
library(qwraps2)
library(tidyverse)
library(tableone)
library(bengaltiger)
library(graphics)
library(caret)
library(emmeans)
library(car)
library(effects)
library(ordinal)
library(scales)
##Source functions
source("R/import_data.R")
source("R/clean_data.R")
source("R/describe_missing_data.R")
source("R/describe_data.R")
source("R/finalize_dataset.R")
source("R/create_sample_characteristics_table.R")
## Import dataset (Using import_data function)
dirty.data <- import_data("taft-dataset-collated-20200608232208.csv")
## Clean data (Using clean_data function)
clean.data <- clean_data(dirty.data)
## Data description
data.description <- describe_data(clean.data)
## Creating dataset with variables selected for this study
final.dataset <- finalize_dataset(clean.data)
## Describing missing data (using describe_missing_data)
descriptions <- describe_missing_data(final.dataset)
##Creating a model with age and gender
model1 <- lm(eq5dhs ~ age*sex, data = final.dataset)
#Interaction term indicated by a * is equivalent to adding the lower order terms to the interaction term
summary(model1)
##Interaction not significant
##Calculating the VIF using the car package
vif(model1)
##It is above 5 for age (7.5) and the interaction factor (8.8)
##Standardizing age and interaction factor by Centering: subtracting by mean and dividing by SD
final.dataset$centred.age <- (final.dataset$age - mean(final.dataset$age, na.rm = TRUE)) / sd(final.dataset$age, na.rm = TRUE)
##New model using centred age
cent.model1 <- lm(eq5dhs ~ centred.age*sex, data = final.dataset)
summary(cent.model1)
##Estimate values do change a bit
vif(cent.model1)
##But all the VIFs are less than 5
#Adjusting for Mechanism of injury, Mode of transport, Transfer status, type of injury, GCS, Respirator Rate, systolic blood pressure, heart rate, oxygen saturation)
model2 <- lm(eq5dhs ~ moi.grouped + mot.grouped + tran + tyi + gcs + rr + hr + sbp + hr + spo2 + centred.age*sex, data = final.dataset)
summary(model2)
##Interaction not significant. Interaction coefficient is -1.13 and after adjusting it is -1.59.
vif(model2)
##All values below 5
##Checking for individual slopes by sex  using the emtrends function
emtrends(model2, ~ sex, var = "centred.age")
##The slopes are not significant for males or females
##Testing difference in slope of male and slope of females using the pairwise argument
emtrends(model2, pairwise ~ sex, var = "centred.age")
##Interaction of age and gender is not significant.
##Plotting the interaction using the emmip function
##Defining the categories
(categories1 <- list(centred.age = seq(-1.32,3.10, by = 0.1), sex = c("Female","Male")))
plot1 <- emmip(model2, sex ~ centred.age,at = categories1, CIs=TRUE)
##saving plot
jpeg("plot-1.Health-Status.jpeg", quality = 100)
emmip(model2, sex ~ centred.age,at = categories1, CIs=TRUE)
dev.off()
##Overall, with older age it is men who tend to have low QOL, while young women have lower QOL than your men. However, the large overlap of confidence interval indicates EQ5D Health status across age is not statistically different for men and women after adjusting.
##Dividing age into categories and comparing interaction over sex
##Making age into categorical
final.dataset$agegrp <- cut(final.dataset$age, c(17,32,49,89), labels = c("18-32","33-49","50 and above"))
##Making male the reference group and age group 18-32 the reference group as they had the highest QOL
final.dataset$agegrp2 <- relevel(final.dataset$agegrp, ref = "18-32")
final.dataset$sex2 <- relevel(final.dataset$sex, ref = "Male")
model3 <- lm(eq5dhs ~ sex2*agegrp2, data = final.dataset)
summary(model3)
## Younger men aged (aged 18-25) had significantly higher QOL scores than the middle aged men (aged 33-49). Older women and younger women had better QOL scores than younger women. All other groups had lower scores than younger men.
vif(model3)
##All values are less than 5
#Adjusting for Mechanism of injury, Mode of transport, Transfer status, type of injury, GCS, Respirator Rate, systolic blood pressure, heart rate, oxygen saturation)
model4 <- lm(eq5dhs ~ moi.grouped + mot.grouped + tran + tyi + gcs + rr + hr + sbp + hr + spo2 + sex2*agegrp2, data = final.dataset)
summary(model4)
##As before above, younger men aged (aged 18-25) had significantly higher QOL scores than the middle aged men (aged 33-49) (Estimate -4.86). Older women (Estimate 3.5) had much better QOL scores than younger men, while younger women had marginally better QOL scores than younger men (Estimate 0.5). All other groups had lower scores than younger men.
vif(model4)
##All values are less than 5
##Calculating the values of QOL by all possible combinations of the age and sex categories
cat.values <- emmeans(model4, ~ sex2*agegrp2)
##Estimating the differences in interactions across age and sex categories interaction using contrast function and argument "revpairwise" as Female is the default in the data set
contrast(cat.values, "revpairwise", by ="agegrp2")
##Age and gender effect is not significant for QOL scores in this data set
##Plotting age categorical interaction
plot2 <- emmip(model4, sex2 ~ agegrp2, CIs = TRUE)
##Saving plot
jpeg("plot-2.Health-Status.jpeg", quality = 100)
emmip(model4, sex2 ~ agegrp2, CIs = TRUE)
dev.off()
##Middle aged women (33-49) seem to have the lowest QOL Scores.
##EQ5D Domains
## Mobility
##Creating a model with age and gender using the polr function
m.model1 <- polr(eq5dm ~ age*sex, data = final.dataset)
#Interaction term indicated by a * is equivalent to adding the lower order terms to the interaction term
summary(m.model1)
m.model.ci <- confint.default(m.model1)
##As the estimates are ordered log odds converting them to odds ratios
exp(cbind(OR = coef(m.model1), m.model.ci))
##For males the odds of having some mobility problems was 1.05 times that of females. For every one year increase in age the odds of some mobility problems increases by 1.019 times (i.e. increases by 1.9%).The interaction factor reduces the odds of having some mobility problems by 1% [(1- 0.99*100)].??
#Adjusting for Mechanism of injury, Mode of transport, Transfer status, type of injury, GCS, Respirator Rate, systolic blood pressure, heart rate, oxygen saturation)
m.model2 <- polr(eq5dm ~ moi.grouped + mot.grouped + tran + tyi + gcs + rr + hr + sbp + hr + spo2 + age*sex, data = final.dataset)
summary(m.model2)
m.model2.ci <- confint.default(m.model2)
##As the estimates are ordered log odds converting them to odds ratios
exp(cbind(OR = coef(m.model2), m.model2.ci))
##After adjusting, for males the odds of having some mobility problems was 1.14 times that of females. For every one year increase in age the odds of some mobility problems increases by 1.012 times (i.e. increases by 1.2%).The interaction factor reduces the odds of having some mobility problems by 1% [(1- 0.99*100)].??
##Checking for individual slopes by sex  using the emtrends function
emtrends(m.model2, ~ sex, var = "age")
##The slopes are not significant for males or females
##Testing difference in slope of male and slope of females using the pairwise argument
emtrends(m.model2, pairwise ~ sex, var = "age")
##Interaction of age and gender is not significant. The adjusted interaction factor is 0.0037
##Plotting the interaction using the emmip function
##Defining the categories
(categories1 <- list(age = seq(17,89, by = 5), sex = c("Female","Male")))
m.plot1 <- emmip(m.model2, sex ~ age, at = categories1, type = "response", CIs=TRUE)
##saving plot
jpeg("plot-1.Mobility.jpeg", quality = 100)
emmip(m.model2, sex ~ age, at = categories1, type = "response", CIs=TRUE)
dev.off()
##Tried the scales package and the scale function in emmip scales = exp_trans(), ylim = c(0, 2) or scales = log10_trans(). It doesn't seem to work
##Using effects package for a stacked plot
jpeg("plot-1.Mobility_Stacked.jpeg", quality = 100)
plot(Effect(focal.predictors = c("age","sex"), mod = m.model2),
rug = FALSE,
style="stacked")
dev.off()
##Using effects package for a split groups plot
jpeg("plot-1.Mobility_Split.jpeg", quality = 100)
plot(Effect(focal.predictors = c("age","sex"), mod = m.model2),
rug = FALSE)
dev.off()
##Dividing age into categories and comparing interaction over sex
m.model3 <- polr(eq5dm ~ sex2*agegrp2, data = final.dataset)
summary(m.model3)
m.model3.ci <- confint.default(m.model3)
##As the estimates are ordered log odds converting them to odds ratios
exp(cbind(OR = coef(m.model3), m.model3.ci))
## For younger females (18-32), middle aged females (33-49), older females (50 and above) the odds of having some mobility problems was 1.08, 1.04, and 1.06 times that of younger males (18-32). The odds of middle aged males (33-49) and older males (50 and above) having some mobility problems was 1.51 and 1.47 times than younger males. For every one year increase in age the odds of some mobility problems increases by 1.012 times (i.e. increases by 1.2%).
#Adjusting for Mechanism of injury, Mode of transport, Transfer status, type of injury, GCS, Respirator Rate, systolic blood pressure, heart rate, oxygen saturation)
m.model4 <- polr(eq5dm ~ moi.grouped + mot.grouped + tran + tyi + gcs + rr + hr + sbp + hr + spo2 + sex2*agegrp2, data = final.dataset)
summary(m.model4)
m.model4.ci <- confint.default(m.model4)
##As the estimates are ordered log odds converting them to odds ratios
exp(cbind(OR = coef(m.model4), m.model4.ci))
## After adjusting, for younger females (18-32), middle aged females (33-49), older females (50 and above) the odds of having some mobility problems was 1.05, 1.04, and 1.04 times that of younger males (18-32). The odds of middle aged males (33-49) and older males (50 and above) having some mobility problems was 1.42 and 1.57 times than younger males. All groups had higher odds of having some mobility problems than young males.
##Calculating the values of mobility by all possible combinations of the age and sex categories
m.cat.values <- emmeans(m.model4, ~ sex2*agegrp2, type = "response")
##Estimating the differences in interactions across age and sex categories interaction using pairs function as these are logs of odds
##Age and gender effect is not significant for QOL scores in this data set
##Plotting age categorical interaction
m.plot2 <- emmip(m.model4, sex2 ~ agegrp2, type = "response", CIs = TRUE)
##Saving plot
jpeg("plot-2.Mobility.jpeg", quality = 100)
emmip(m.model4, sex2 ~ agegrp2, CIs = TRUE)
dev.off()
##Using effects package for a stacked plot
jpeg("plot-2.Mobility_Stacked.jpeg", quality = 100)
plot(Effect(focal.predictors = c("agegrp2","sex2"), mod = m.model4),
rug = FALSE,
style="stacked")
dev.off()
##Using effects package for a split groups plot
jpeg("plot-2.Mobility_Split.jpeg", quality = 100)
plot(Effect(focal.predictors = c("agegrp2","sex2"), mod = m.model4),
rug = FALSE)
dev.off()
##Self-care
##Creating a model with age and gender using the polr function
sc.model1 <- polr(eq5dsc ~ age*sex, data = final.dataset)
#Interaction term indicated by a * is equivalent to adding the lower order terms to the interaction term
summary(sc.model1)
sc.model.ci <- confint.default(sc.model1)
##As the estimates are ordered log odds converting them to odds ratios
exp(cbind(OR = coef(sc.model1), sc.model.ci))
##For males the odds of having some self-care problems was 0.63 times that of females. For every one year increase in age the odds of some mobility problems increases by 0.5%.The interaction factor does not change the odds of having self-care [1.008].
#Adjusting for Mechanism of injury, Mode of transport, Transfer status, type of injury, GCS, Respirator Rate, systolic blood pressure, heart rate, oxygen saturation)
sc.model2 <- polr(eq5dsc ~ moi.grouped + mot.grouped + tran + tyi + gcs + rr + hr + sbp + hr + spo2 + age*sex, data = final.dataset)
summary(sc.model2)
sc.model2.ci <- confint.default(sc.model2)
##As the estimates are ordered log odds converting them to odds ratios
exp(cbind(OR = coef(sc.model2), sc.model2.ci))
##After adjusting, for males the odds of having some mobility problems was 0.57 times that of females. For every one year increase in age the odds of some mobility problems increased by 1 times (i.e. increases by 0.99%).The interaction factor did not change the odds of having self-care [1.008].
##Checking for individual slopes by sex  using the emtrends function
emtrends(sc.model2, ~ sex, var = "age")
##The slopes are not significant for males or females
##Testing difference in slope of male and slope of females using the pairwise argument
emtrends(sc.model2, pairwise ~ sex, var = "age")
##Interaction of age and gender is not significant. The adjusted interaction factor is 0.0085
##Plotting the interaction using the emmip function
##Defining the categories
(categories1 <- list(age = seq(17,89, by = 5), sex = c("Female","Male")))
sc.plot1 <- emmip(sc.model2, sex ~ age, at = categories1, type = "response", CIs=TRUE)
##saving plot
jpeg("plot-1.Self-care.jpeg", quality = 100)
emmip(sc.model2, sex ~ age, at = categories1, type = "response", CIs=TRUE)
dev.off()
##Dividing age into categories and comparing interaction over sex
sc.model3 <- polr(eq5dsc ~ sex2*agegrp2, data = final.dataset)
summary(sc.model3)
sc.model3.ci <- confint.default(sc.model3)
##As the estimates are ordered log odds converting them to odds ratios
exp(cbind(OR = coef(sc.model3), sc.model3.ci))
## For younger females (18-32), middle aged females (33-49), older females (50 and above) the odds of having some problems performing self-care were 1.27, 1.22, and 0.92 times that of younger males (18-32). The odds of middle aged males (33-49) and older males (50 and above) having some problems performing self-care was 1.46 and 1.43 times than younger males.
#Adjusting for Mechanism of injury, Mode of transport, Transfer status, type of injury, GCS, Respirator Rate, systolic blood pressure, heart rate, oxygen saturation)
sc.model4 <- polr(eq5dsc ~ moi.grouped + mot.grouped + tran + tyi + gcs + rr + hr + sbp + hr + spo2 + sex2*agegrp2, data = final.dataset)
summary(sc.model4)
sc.model4.ci <- confint.default(sc.model4)
##As the estimates are ordered log odds converting them to odds ratios
exp(cbind(OR = coef(sc.model4), sc.model4.ci))
## After adjusting, for younger females (18-32), middle aged females (33-49), older females (50 and above) the odds of having some problems performing self-care was 1.32, 1.16, and 0.78 times that of younger males (18-32). The odds of middle aged males (33-49) and older males (50 and above) some problems performing self-care was 1.33 and 1.07 times than younger males. Only older females had lower odds of problems with self-care than young males.
##Calculating the values of mobility by all possible combinations of the age and sex categories
sc.cat.values <- emmeans(sc.model4, ~ sex2*agegrp2, type = "response")
##Estimating the differences in interactions across age and sex categories interaction using pairs function as these are logs of odds
##Age and gender effect is not significant for QOL scores in this data set
##Plotting age categorical interaction
sc.plot2 <- emmip(sc.model4, sex2 ~ agegrp2, type = "response", CIs = TRUE)
##Saving plot
jpeg("plot-2.Self-care.jpeg", quality = 100)
emmip(sc.model4, sex2 ~ agegrp2, type = "response", CIs = TRUE)
dev.off()
##Usual activities
##Creating a model with age and gender using the polr function
ua.model1 <- polr(eq5dua ~ age*sex, data = final.dataset)
#Interaction term indicated by a * is equivalent to adding the lower order terms to the interaction term
summary(ua.model1)
ua.model.ci <- confint.default(ua.model1)
##As the estimates are ordered log odds converting them to odds ratios
exp(cbind(OR = coef(ua.model1), ua.model.ci))
##For males the odds of having some problems in performing usual activities was 0.79 times that of females. For every one year increase in age the odds of some mobility problems increases by 1.2%.The interaction factor does not affect the odds of having self-care [1.002].
#Adjusting for Mechanism of injury, Mode of transport, Transfer status, type of injury, GCS, Respirator Rate, systolic blood pressure, heart rate, oxygen saturation)
ua.model2 <- polr(eq5dua ~ moi.grouped + mot.grouped + tran + tyi + gcs + rr + hr + sbp + hr + spo2 + age*sex, data = final.dataset)
summary(ua.model2)
ua.model2.ci <- confint.default(ua.model2)
##As the estimates are ordered log odds converting them to odds ratios
exp(cbind(OR = coef(ua.model2), ua.model2.ci))
##After adjusting, for males the odds of having some mobility problems was 0.73 times that of females. For every one year increase in age the odds of some mobility problems increased by 1 times (i.e. increases by 0.99%).The interaction factor did not change the odds of having self-care [1.005].
##Checking for individual slopes by sex  using the emtrends function
emtrends(ua.model2, ~ sex, var = "age")
##The slopes are not significant for males or females
##Testing difference in slope of male and slope of females using the pairwise argument
emtrends(ua.model2, pairwise ~ sex, var = "age")
##Interaction of age and gender is not significant. The adjusted interaction factor is 0.0053
##Plotting the interaction using the emmip function
##Defining the categories
(categories1 <- list(age = seq(17,89, by = 5), sex = c("Female","Male")))
ua.plot1 <- emmip(ua.model2, sex ~ age, at = categories1, type = "response", CIs=TRUE)
##saving plot
jpeg("plot-1.Usual-activities.jpeg", quality = 100)
emmip(ua.model2, sex ~ age, at = categories1, type = "response", CIs=TRUE)
dev.off()
##Dividing age into categories and comparing interaction over sex
ua.model3 <- polr(eq5dua ~ sex2*agegrp2, data = final.dataset)
summary(ua.model3)
ua.model3.ci <- confint.default(ua.model3)
##As the estimates are ordered log odds converting them to odds ratios
exp(cbind(OR = coef(ua.model3), ua.model3.ci))
## For younger females (18-32), middle aged females (33-49), older females (50 and above) the odds of having some problems performing usual activities were 1.24, 0.92, and 0.89 times that of younger males (18-32). The odds of middle aged males (33-49) and older males (50 and above) having some problems performing self-care was 1.68 and 1.53 times than younger males.
#Adjusting for Mechanism of injury, Mode of transport, Transfer status, type of injury, GCS, Respirator Rate, systolic blood pressure, heart rate, oxygen saturation)
ua.model4 <- polr(eq5dua ~ moi.grouped + mot.grouped + tran + tyi + gcs + rr + hr + sbp + hr + spo2 + sex2*agegrp2, data = final.dataset)
summary(ua.model4)
ua.model4.ci <- confint.default(ua.model4)
##As the estimates are ordered log odds converting them to odds ratios
exp(cbind(OR = coef(ua.model4), ua.model4.ci))
## After adjusting, for younger females (18-32), middle aged females (33-49), older females (50 and above) the odds of having some problems performing usual activities was 1.32, 0.79, and 0.80 times than of younger males (18-32). The odds of middle aged males (33-49) and older males (50 and above) some problems performing usual activities was 1.69 and 1.24 times than young males. Only middle aged and older females had lower odds of having problems performing usual activities than young males.
##Calculating the values of mobility by all possible combinations of the age and sex categories
ua.cat.values <- emmeans(ua.model4, ~ sex2*agegrp2, type = "response")
##Estimating the differences in interactions across age and sex categories interaction using pairs function as these are logs of odds
##Age and gender effect is not significant for QOL scores in this data set
##Plotting age categorical interaction
ua.plot2 <- emmip(ua.model4, sex2 ~ agegrp2, type = "response", CIs = TRUE)
##Saving plot
jpeg("plot-2.Usual-activities.jpeg", quality = 100)
emmip(ua.model4, sex2 ~ agegrp2, type = "response", CIs = TRUE)
dev.off()
##Pain and discomfort
##Creating a model with age and gender using the polr function
pd.model1 <- polr(eq5dpd ~ age*sex, data = final.dataset)
#Interaction term indicated by a * is equivalent to adding the lower order terms to the interaction term
summary(pd.model1)
pd.model.ci <- confint.default(pd.model1)
##As the estimates are ordered log odds converting them to odds ratios
exp(cbind(OR = coef(pd.model1), pd.model.ci))
##For males the odds of having any form of pain or discomfort was 0.32 times that of females. For every one year increase in age the odds of any pain or discomfort increases by 1%.The interaction factor reduces the odds of  affect the odds of pain or discomfort by 22% [1-1.022*100].
#Adjusting for Mechanism of injury, Mode of transport, Transfer status, type of injury, GCS, Respirator Rate, systolic blood pressure, heart rate, oxygen saturation)
pd.model2 <- polr(eq5dpd ~ moi.grouped + mot.grouped + tran + tyi + gcs + rr + hr + sbp + hr + spo2 + age*sex, data = final.dataset)
summary(pd.model2)
pd.model2.ci <- confint.default(pd.model2)
##As the estimates are ordered log odds converting them to odds ratios
exp(cbind(OR = coef(pd.model2), pd.model2.ci))
##After adjusting, for males the odds of having pain or discomfort was 0.32 times that of females. For every one year increase in age the odds of any pain or discomfort increased by 1%.The interaction factor reduces the odds of  affect the odds of pain or discomfort by 21% [1-1.021*100]..
##Checking for individual slopes by sex  using the emtrends function
emtrends(pd.model2, ~ sex, var = "age")
##The slopes are not significant for males or females
##Testing difference in slope of male and slope of females using the pairwise argument
emtrends(pd.model2, pairwise ~ sex, var = "age")
##Interaction of age and gender is not significant. The adjusted interaction factor is 0.021
##Plotting the interaction using the emmip function
##Defining the categories
(categories1 <- list(age = seq(17,89, by = 5), sex = c("Female","Male")))
pd.plot1 <- emmip(pd.model2, sex ~ age, at = categories1, type = "response", CIs=TRUE)
##saving plot
jpeg("plot-1.Pain-Discomfort.jpeg", quality = 100)
emmip(pd.model2, sex ~ age, at = categories1, type = "response", CIs=TRUE)
dev.off()
##Dividing age into categories and comparing interaction over sex
pd.model3 <- polr(eq5dpd ~ sex2*agegrp2, data = final.dataset)
summary(pd.model3)
pd.model3.ci <- confint.default(pd.model3)
##As the estimates are ordered log odds converting them to odds ratios
exp(cbind(OR = coef(pd.model3), pd.model3.ci))
## For younger females (18-32), middle aged females (33-49), older females (50 and above) the odds of having some pain or discomfort were 1.69, 0.62, and 0.62 times that of younger males (18-32). The odds of middle aged males (33-49) and older males (50 and above) having any pain was 2.07 and 2.03 times than younger males.
#Adjusting for Mechanism of injury, Mode of transport, Transfer status, type of injury, GCS, Respirator Rate, systolic blood pressure, heart rate, oxygen saturation)
pd.model4 <- polr(eq5dpd ~ moi.grouped + mot.grouped + tran + tyi + gcs + rr + hr + sbp + hr + spo2 + sex2*agegrp2, data = final.dataset)
summary(pd.model4)
pd.model4.ci <- confint.default(pd.model4)
##As the estimates are ordered log odds converting them to odds ratios
exp(cbind(OR = coef(pd.model4), pd.model4.ci))
## After adjusting, for younger females (18-32), middle aged females (33-49), older females (50 and above) the odds of having any pain was 1.7, 0.58, and 0.60 times that of younger males (18-32). The odds of middle aged males (33-49) and older males (50 and above) some problems performing usual activities was 2.1 and 1.9 times than younger males. Only Middle aged and older males had lower odds of having any form of pain or discomfort than younger males.
##Calculating the values of mobility by all possible combinations of the age and sex categories
pd.cat.values <- emmeans(pd.model4, ~ sex2*agegrp2, type = "response")
##Estimating the differences in interactions across age and sex categories interaction using pairs function as these are logs of odds
##Age and gender effect is not significant for QOL scores in this data set
##Plotting age categorical interaction
pd.plot2 <- emmip(pd.model4, sex2 ~ agegrp2, type = "response", CIs = TRUE)
##Saving plot
jpeg("plot-2.Pain-discomfort.jpeg", quality = 100)
emmip(pd.model4, sex2 ~ agegrp2, type = "response", CIs = TRUE)
dev.off()
##Anxiety & Depression
##Creating a model with age and gender using the polr function
ad.model1 <- polr(eq5dad ~ age*sex, data = final.dataset)
#Interaction term indicated by a * is equivalent to adding the lower order terms to the interaction term
summary(ad.model1)
ad.model.ci <- confint.default(ad.model1)
##As the estimates are ordered log odds converting them to odds ratios
exp(cbind(OR = coef(ad.model1), ad.model.ci))
##For males the odds of having any form of anxiety and depression  was 0.32 times that of females. For every one year increase in age the odds of any anxiety and depression increases by 1%.The interaction factor does not seem to affect odds of anxiety or depression [1-1.0048*100].
#Adjusting for Mechanism of injury, Mode of transport, Transfer status, type of injury, GCS, Respirator Rate, systolic blood pressure, heart rate, oxygen saturation)
ad.model2 <- polr(eq5dad ~ moi.grouped + mot.grouped + tran + tyi + gcs + rr + hr + sbp + hr + spo2 + age*sex, data = final.dataset)
summary(ad.model2)
ad.model2.ci <- confint.default(ad.model2)
##As the estimates are ordered log odds converting them to odds ratios
exp(cbind(OR = coef(ad.model2), ad.model2.ci))
##After adjusting, for males the odds of having any anxiety or depression was 0.77 times that of females. For every one year increase in age the odds of any pain or discomfort increased by 1%.The interaction factor does not show to affect the odds of anxiety or depression [1-1.003*100]..
##Checking for individual slopes by sex  using the emtrends function
emtrends(ad.model2, ~ sex, var = "age")
##The slopes are not significant for males or females
##Testing difference in slope of male and slope of females using the pairwise argument
emtrends(ad.model2, pairwise ~ sex, var = "age")
##Interaction of age and gender is not significant. The adjusted interaction factor is 0.032
##Plotting the interaction using the emmip function
##Defining the categories
(categories1 <- list(age = seq(17,89, by = 5), sex = c("Female","Male")))
ad.plot1 <- emmip(ad.model2, sex ~ age, at = categories1, type = "response", CIs=TRUE)
##saving plot
jpeg("plot-1.Anxiety-Depresssion.jpeg", quality = 100)
emmip(ad.model2, sex ~ age, at = categories1, type = "response", CIs=TRUE)
dev.off()
##Dividing age into categories and comparing interaction over sex
ad.model3 <- polr(eq5dad ~ sex2*agegrp2, data = final.dataset)
summary(ad.model3)
ad.model3.ci <- confint.default(ad.model3)
##As the estimates are ordered log odds converting them to odds ratios
exp(cbind(OR = coef(ad.model3), ad.model3.ci))
## For younger females (18-32), middle aged females (33-49), older females (50 and above) the odds of having any anxiety and depression were 1.51, 0.47, and 1.03 times that of younger males (18-32). The odds of middle aged males (33-49) and older males (50 and above) having any anxiety and depression was 1.79 and 1.1 times than younger males.
#Adjusting for Mechanism of injury, Mode of transport, Transfer status, type of injury, GCS, Respirator Rate, systolic blood pressure, heart rate, oxygen saturation)
ad.model4 <- polr(eq5dad ~ moi.grouped + mot.grouped + tran + tyi + gcs + rr + hr + sbp + hr + spo2 + sex2*agegrp2, data = final.dataset)
summary(ad.model4)
ad.model4.ci <- confint.default(ad.model4)
##As the estimates are ordered log odds converting them to odds ratios
exp(cbind(OR = coef(ad.model4), ad.model4.ci))
## After adjusting, for younger females (18-32), middle aged females (33-49), older females (50 and above) the odds of having any anxiety and depression was 1.39, 0.48, and 1.10 times that of younger males (18-32). The odds of middle aged males (33-49) and older males (50 and above) some anxiety and depression was 1.59 and 0.84 times than younger males. Only Older males and middle aged females had lower  odds of having any form of anxiety and depression than younger males.
##Calculating the values of mobility by all possible combinations of the age and sex categories
ad.cat.values <- emmeans(ad.model4, ~ sex2*agegrp2, type = "response")
##Estimating the differences in interactions across age and sex categories interaction using pairs function as these are logs of odds
##Age and gender effect is not significant for QOL scores in this data set
##Plotting age categorical interaction
ad.plot2 <- emmip(ad.model4, sex2 ~ agegrp2, type = "response", CIs = TRUE)
##Saving plot
jpeg("plot-2.Anxiety-Depression.jpeg", quality = 100)
emmip(ad.model4, sex2 ~ agegrp2, type = "response", CIs = TRUE)
dev.off()
View(descriptions)
n.row(clean.data$pid)
count(clean.data$pid)
nrow(clean.data$pid)
nrow(clean.data$pid, na.rm = TRUE)
nrow(clean.data, na.rm = TRUE)
nrow(clean.data)
total.patients <- nrow(clean.data)
descriptions[["total.incomplete"]][["n"]]
description$total.patients
dataset$total.patients
missing.patients <- descriptions[["total.incomplete"]][["n"]]
descriptions[["eq5dhs"]]
class(total.patients)
final.patients <- total.patients - missing.patients
final.patients
dataset$total.patients
r dataset$total.patients
data.description
data.description$p.assualt
data.description$p.assault
hs.complete <- nrow(final.dataset$eq5dhs)
hs.complete
hs.complete <- nrow(final.dataset$eq5dhs, na.rm =TRUE)
hs.complete <- NROW(final.dataset$eq5dhs, na.rm =TRUE)
hs.complete <- NROW(final.dataset$eq5dhs)
hs.complete
hs.complete <- NROW(final.dataset$eq5dhs)
hs.complete
hs.complete <- descriptions[["eq5dhs"]][["n"]] - NROW(final.dataset$eq5dhs)
hs.complete
hs.complete <- NROW(final.dataset$eq5dhs) - descriptions[["eq5dhs"]][["n"]]
hs.complete
mean(final.dataset$eq5dhs)
mean(final.dataset$eq5dhs, na.rm = T)
hs.mean <- mean(final.dataset$eq5dhs, na.rm = T)
hs.mean
descriptions[["eq5dhs"]][["n"]]
table(final.dataset$eq5dm)
View(data.description)
sample.charac <- create_sample_characteristics_table(final.dataset)
source("R/create_sample_characteristics_table.R")
sample.charac <- create_sample_characteristics_table(final.dataset)
View(sample.charac)
kable(sample.characteristics.table$table, caption = sample.characteristics.table$caption, format = "pandoc")
kable(sample.charac$table, caption = sample.characteristics.table$caption, format = "pandoc")
kable(sample.charac$table, caption = sample.charac$caption, format = "pandoc")
kable(sample.charac$table, caption = sample.charac$caption, format = "pandoc")
cat(sample.charac$note)
kable(sample.charac$table, caption = sample.charac$caption, format = "pandoc")
class(sample.charac)
sample.charac[["table"]][["42"]]
sample.charac
sample.charac[["3"]][["42"]]
sample.charac[["table"]][["42"]][["1"]]
sample.charac$note
sample.charac$table[["42"]][["1"]]
sample.charac
summary(model2)
summary(model4)
exp(cbind(OR = coef(m.model4), m.model4.ci))
mobility.odds <- exp(cbind(OR = coef(m.model4), m.model4.ci))
View(mobility.odds)
sample.charac$not
mobility.odds[[1]][[2]]
class(mobility.odds)
mobility.odds[1,2]
mobility.odds["sex2Female", "OR"]
m.middle.fem <- mobility.odds["sex2Female:agegrp233-49", "OR"]
m.middle.fem
m.old.fem <- mobility.odds["sex2Female:agegrp250 and above", "OR"]
m.old.fem
m.middle.mal <- mobility.odds["agegrp233-49", "OR"]
m.middle.mal
m.young.fem <- mobility.odds["sex2Female", "OR"]
m.middle.fem <- mobility.odds["sex2Female:agegrp233-49", "OR"]
m.old.fem <- mobility.odds["sex2Female:agegrp250 and above", "OR"]
m.middle.mal <- mobility.odds["agegrp233-49", "OR"]
m.old.mal <- mobility.odds["agegrp250 and above", "OR"]
sc.odds <- exp(cbind(OR = coef(sc.model4), sc.model4.ci))
sc.odds <- exp(cbind(OR = coef(sc.model4), sc.model4.ci))
##OR
sc.young.fem <- sc.odds["sex2Female", "OR"]
sc.middle.fem <- sc.odds["sex2Female:agegrp233-49", "OR"]
sc.old.fem <- sc.odds["sex2Female:agegrp250 and above", "OR"]
sc.middle.mal <- sc.odds["agegrp233-49", "OR"]
sc.old.mal <- sc.odds["agegrp250 and above", "OR"]
sc.old.mal
sc.middle.mal
ua.odds <- exp(cbind(OR = coef(ua.model4), ua.model4.ci))
##OR
ua.young.fem <- ua.odds["sex2Female", "OR"]
ua.middle.fem <- ua.odds["sex2Female:agegrp233-49", "OR"]
ua.old.fem <- ua.odds["sex2Female:agegrp250 and above", "OR"]
ua.middle.mal <- ua.odds["agegrp233-49", "OR"]
ua.old.mal <- ua.odds["agegrp250 and above", "OR"]
ua.old.mal
pd.young.fem <- pd.odds["sex2Female", "OR"]
pd.odds <- exp(cbind(OR = coef(pd.model4), pd.model4.ci))
pd.young.fem <- pd.odds["sex2Female", "OR"]
pd.middle.fem <- pd.odds["sex2Female:agegrp233-49", "OR"]
pd.old.fem <- pd.odds["sex2Female:agegrp250 and above", "OR"]
pd.middle.mal <- pd.odds["agegrp233-49", "OR"]
pd.old.mal <- pd.odds["agegrp250 and above", "OR"]
pd.old.mal
ad.odds <-exp(cbind(OR = coef(ad.model3), ad.model3.ci))
##OR
ad.young.fem <- ad.odds["sex2Female", "OR"]
ad.middle.fem <- ad.odds["sex2Female:agegrp233-49", "OR"]
ad.old.fem <- ad.odds["sex2Female:agegrp250 and above", "OR"]
ad.middle.mal <- ad.odds["agegrp233-49", "OR"]
ad.old.mal <- ad.odds["agegrp250 and above", "OR"]
ad.old.mal
